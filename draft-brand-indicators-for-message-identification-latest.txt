



Authindicators Working Group                                    T. Loder
Internet-Draft                                                     Agari
Intended status: Informational                                   T. Zink
Expires: July 27, 2017                                         Microsoft
                                                            P. Goldstein
                                                                ValiMail
                                                        January 23, 2017


           Brand Indicators for Message Identification (BIMI)
        draft-brand-indicators-for-message-identification-latest

Abstract

   Brand Indicators for Message Identification (BIMI) is a scalable
   mechanism by which mail-originating organizations and Mail User
   Agents (MUAs) can coordinate on displaying brand-specific indicators
   next to properly authenticated messages.

   To benefit their users, Mail User Agents need to be able to
   effectively and meaningfully convey that messages being displayed are
   both authenticated and originate from a known organization.  Brand-
   specific indicators are believed to be a more effective method of
   communicating message authenticity to end users.  Thus there is a
   need for MUAs to have access to brand-specific imagery for a very
   large number of brands.

   Those brands have an interest in ensuring that the imagery displayed
   in these situations is correct and appropriate, so it is desirable to
   provide a mechanism to allow these mail-originating organizations to
   provide imagery to MUAs.  This mechanism removes the substantial
   burden of curating and maintaining an image database from the MUAs,
   and allows each brand to manage its own imagery.  As an additional
   benefit, mail-originating organizations are more likely to invest the
   time and effort to authenticate their email, should that come with
   the ability to influence how email from the organization is
   displayed.

   By itself BIMI does not impose specific requirements for indicator
   display on MUAs.  BIMI is just a mechanism to support coordination
   between mail-originating organizations and MUAs.  MUAs and mail-
   receiving organizations are free to define their own policies for
   indicator display that makes use or not of BIMI data as they see fit.








Loder, et al.             Expires July 27, 2017                 [Page 1]

Internet-DrafBrand Indicators for Message Identification (B January 2017


Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 27, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
     1.1.  The Need for Standardization  . . . . . . . . . . . . . .   3
     1.2.  Outline . . . . . . . . . . . . . . . . . . . . . . . . .   4
   2.  Requirements  . . . . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  High-Level Goals  . . . . . . . . . . . . . . . . . . . .   4
     2.2.  Out of Scope  . . . . . . . . . . . . . . . . . . . . . .   5
     2.3.  Scalability . . . . . . . . . . . . . . . . . . . . . . .   5
   3.  Terminology and Definitions . . . . . . . . . . . . . . . . .   5
   4.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   6
     4.1.  Selectors . . . . . . . . . . . . . . . . . . . . . . . .   7
     4.2.  Use of RFC5322.From . . . . . . . . . . . . . . . . . . .   7
   5.  Policy  . . . . . . . . . . . . . . . . . . . . . . . . . . .   7
     5.1.  Assertion Record  . . . . . . . . . . . . . . . . . . . .   8
     5.2.  General Record Format . . . . . . . . . . . . . . . . . .   8



Loder, et al.             Expires July 27, 2017                 [Page 2]

Internet-DrafBrand Indicators for Message Identification (B January 2017


     5.3.  Formal Definition . . . . . . . . . . . . . . . . . . . .   9
     5.4.  Indicator Discovery . . . . . . . . . . . . . . . . . . .   9
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  10
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .  10
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   The Sender Policy Framework ([SPF]), DomainKeys Identified Mail
   ([DKIM]), and Domain-based Message Authentication, Reporting, and
   Conformance ([DMARC]) provide mechanisms for domain-level
   authentication for email messages.  They enable cooperating email
   senders and receivers to distinguish messages that are authorized to
   use the domain name from those that are not.  Given that not all
   senders employ these authentication mechanisms, it is desirable that
   Mail User Agents be able to indicate to their end users that
   particular messages are authenticated.

   It is currently possible for Mail User Agents to indicate the
   validity of messages authenticated via these mechanisms through the
   use of generic indicators - checkmarks and the like.  But there is a
   belief that the effectiveness of such generic indicators is limited,
   and that end users are better served through the use of brand
   indicators associated with the authenticated sender of the message.

1.1.  The Need for Standardization

   Over time, some mail-receiving organizations have developed closed
   systems for displaying brand indicators for some select domains.
   While this enabled these mail-receiving organizations to display
   brand indicators for a limited subset of messages, this closed
   approach has significant downsides.  Namely:

   1.  It puts a significant burden on each mail-receiving organization,
       because they must identify and manage a large database of brand
       indicators.

   2.  Scalability is challenging for closed systems that attempt to
       capture complete sets of data across the whole of the Internet.

   3.  A lack of uniformity across different mail-receiving
       organizations - each organization will have its own indicator
       set, which may or may not agree with those maintained by other
       organizations for any given domain.

   4.  Domain owners have limited ability to influence the brand
       indicator for the domain(s) they own, and such ability they do




Loder, et al.             Expires July 27, 2017                 [Page 3]

Internet-DrafBrand Indicators for Message Identification (B January 2017


       have is likely to require coordination with many mail-receiving
       organizations.

   5.  MUAs that are not associated with a particular mail-receiving
       organization are likely to be disadvantaged, because they are
       unlikely

   This all speaks to the need for a standardized mechanism by which
   Domain Owners can publish and distribute brand indicators for use by
   any participating MUA.

1.2.  Outline

   This document defines Brand Indicators for Message Identification
   (BIMI), a mechanism by which Domain Owners can coordinate with mail-
   receiving organizations and Mail User Agents to express preferred
   brand indicators for display with a given message.

   The basic outline of BIMI is as follows:

   1.  Domain Owners publish brand indicator assertions for domains via
       the DNS.

   2.  Receivers authenticate the messages using [DMARC] and/or whatever
       other authentication mechanisms they wish to apply.

   3.  If the message authenticates, the receiver queries the DNS for a
       corresponding BIMI record.

   4.  If a BIMI record is present, then the receiver adds a header to
       the message, which can be used by the Mail User Agent to
       determine the Domain Owner's preferred brand indicator.

   5.  The Mail User Agent retrieves and displays the brand indicator as
       appropriate based on its policy and user interface.

2.  Requirements

   Specification of BIMI in this document is guided by the following
   high-level goals, security dependencies, detailed requirements, and
   items that are documented as out of scope.

2.1.  High-Level Goals

   BIMI has the following high-level goals:






Loder, et al.             Expires July 27, 2017                 [Page 4]

Internet-DrafBrand Indicators for Message Identification (B January 2017


   o  Enable the authors of Mail User Agents to display meaningful
      imagery associated with the author to recipients of authenticated
      email.

   o  Allow Domain Owners to suggest appropriate images for display with
      authenticated messages originating from their domains.

   o  Provide mechanisms to prevent attempts by malicious Domain Owners
      to fraudulently represent messages from their domains as
      originating with other entities.

   o  Work at Internet Scale

2.2.  Out of Scope

   Several topics and issues are specifically out of scope for the
   initial version of this work.  These include the following:

   o  Defining what consitutes authenticated email for the purposes of
      this standard

   o  Publishing policy other than via the DNS

   o  The explicit mechanisms used by Verifying Protocol Clients - this
      will be deferred to a later document.

2.3.  Scalability

   Scalability is a major issue for systems that need to operate in a
   system as widely deployed as current SMTP email.  For this reason,
   BIMI seeks to avoid the need for pre-sending agreements between
   senders and receivers.  This preserves the positive aspects of the
   current email infrastructure.

3.  Terminology and Definitions

   This section defines terms used in the rest of the document.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [KEYWORDS].

   Readers are encouraged to be familiar with the contents of
   [EMAIL-ARCH].  In particular, that document defines various roles in
   the messaging infrastructure that can appear the same or separate in
   various contexts.  For example, a Domain Owner could, via the
   messaging mechanisms on which BIMI is based, delegate control over
   defining preferred brand indicators as the Domain Owner to a third



Loder, et al.             Expires July 27, 2017                 [Page 5]

Internet-DrafBrand Indicators for Message Identification (B January 2017


   party with another role.  This document does not address the
   distinctions among such roles; the reader is encouraged to become
   familiar with that material before continuing.

   The following terms are also used:

   Author Domain: The domain name of the apparent author, as extracted
   from the RFC5322.From field.

   Domain Owner: An entity or organization that owns a DNS domain.  The
   term "owns" here indicates that the entity or organization being
   referenced holds the registration of that DNS domain.  Domain Owners
   range from complex, globally distributed organizations, to service
   providers working on behalf of non-technical clients, to individuals
   responsible for maintaining personal domains.  This specification
   uses this term as analogous to an Administrative Management Domain as
   defined in [EMAIL-ARCH].

   Mail Receiver: The entity or organization that receives and processes
   email.  Mail Receivers operate one or more Internet-facing Mail
   Transport Agents (MTAs).

   Mark Asserting Entity (MAE): A Domain Owner who publishes information
   via the protocol to facilitate distribution of its graphical icons or
   marks in association with messages for which the domain they "own" is
   the Author Domain.

   Mark Verifying Authority (MVA): An entity of organization that can
   provide evidence of verification of marks asserted by an MAE to
   Verifying Protocol Clients.  The MVA may choose to uphold and confirm
   the meeting of certain mark standards (ie. size, trademark, content,
   etc).

   Protocol Client: An entity that uses the protocol to discover and
   fetch published icons or marks.

   Verifying Protocol Client: A Protocol Client that uses the optional
   verification capability to inquire about the verification status of
   published marks.

4.  Overview

   This section provides a general overview of the design and operation
   of the BIMI environment.







Loder, et al.             Expires July 27, 2017                 [Page 6]

Internet-DrafBrand Indicators for Message Identification (B January 2017


4.1.  Selectors

   To support multiple brand indicators per domain, the brand indicator
   namespace is subdivided using "selectors".  Selectors allow the
   domain owner to better target the brand indicator by type of
   recipient, message source, or other considerations like seasonal
   branding.

   Periods are allowed in selectors and are component separators.  When
   BIMI assertion records are retrieved from the DNS, periods in
   selectors define DNS label boundaries in a manner similar to the
   conventional use in domain names.  In a DNS implementation, this can
   be used to allow delegation of a portion of the selector namespace.

   [ABNF]:

   selector = sub-domain *( "." sub-domain ) ; from [SMTP] Domain, ;
   excluding address-literal

   The number of selectors for each domain is determined by the domain
   owner.  Many domain owners will be satisfied with just one selector,
   whereas organizations with more complex branding requirements can
   choose to manage disparate selectors.

   BIMI supports the notion of a "default" selector.

4.2.  Use of RFC5322.From

5.  Policy

   BIMI policies are published by Domain Owners and applied by Protocol
   Clients.

   A Domain Owner advertises BIMI participation of one or more of its
   domains by adding a DNS TXT record to those domains.  In doing so,
   Domain Owners make specific requests of Mail User Agents regarding
   the preferred set of icons to be displayed with messages purporting
   to be from one of the Domain Owner's domains.

   A Domain Owner may choose not to participate in BIMI.  In this case,
   the Domain Owner simply declines to advertise participation by not
   publishing a BIMI assertion record.

   A Mail User Agent implementing the BIMI mechanism SHOULD make a best-
   effort attempt to adhere to the Domain Owner's published BIMI policy.
   But Mail User Agents have final control over the user interface
   published to their end users, and MAY use alternate indicators than
   those specified in the BIMI assertion record or no indicator at all.



Loder, et al.             Expires July 27, 2017                 [Page 7]

Internet-DrafBrand Indicators for Message Identification (B January 2017


5.1.  Assertion Record

   All Domain Owner BIMI preferences are stored as DNS TXT records in
   subdomains named "_bimi".  BIMI allows the definition of multiple
   preferences associated with a single RFC5322.From domain.  To
   distinguish between these different preferences, BIMI uses selectors.

   For example, the Domain Owner of "example.com" would post BIMI
   preferences in a TXT record at "default._bimi.example.com".
   Similarly, a Mail Receiver wishing to query for BIMI preferences
   regarding mail with an RFC5322.From domain of "example.com" and a
   selector "default" would issue a TXT query to the DNS for the
   subdomain of "default._bimi.example.com".  The DNS-located BIMI
   preference data will hereafter be called the "BIMI assertion record".

   BIMI's use of the Domain Name Service is driven by BIMI's use of
   domain names and the nature of the query it performs.  Use of the DNS
   as the query service has the benefit of reusing an extremely well-
   established operations, administration, and management
   infrastructure, rather than creating a new one.

   Per [DNS], a TXT record can comprise several "character-string"
   objects.  Where this is the case, the module performing DMARC
   evaluation MUST concatenate these strings by joining together the
   objects in order and parsing the result as a single string.

5.2.  General Record Format

   BIMI assertion records follow the extensible "tag-value" syntax for
   DNS-based key records defined in DKIM [DKIM].

   This section creates a registry for known BIMI tags and registers the
   initial set defined in this document.  Only tags defined in this
   document or in later extensions, and thus added to that registry, are
   to be processed; unknown tags MUST be ignored.

   The following tags are introduced as the initial valid BIMI tags:

   a: Trust Authorities (plain-text; OPTIONAL).  A reserved value.

   f: Supported Image Formats (comma-separated plain-text list of
   values; OPTIONAL; default is "png").  Comma-separated list of three
   or four character filename extensions denoting the available file
   formats.  Supported raster formats are TIFF (tiff, tif), PNG (png),
   and JPEG (jpg, jpeg).  Supported vector formats are SVG (svg).

   l: locations (URI).  The value of this tag is a comma separated list
   of base URLs representing the location of the brand logo files.  All



Loder, et al.             Expires July 27, 2017                 [Page 8]

Internet-DrafBrand Indicators for Message Identification (B January 2017


   clients are expected to support use of at least 2 location URIs, used
   in order.  Clients may optionally attempt to use more.  Initially the
   supported transport supported is HTTPS only.

   v: Version (plain-text; REQUIRED).  Identifies the record retrieved
   as a BIMI record.  It MUST have the value of "BIMI1".  The value of
   this tag MUST match precisely; if it does not or it is absent, the
   entire retrieved record MUST be ignored.  It MUST be the first tag in
   the list.

   z: List of supported image sizes (comma-separated plain-text list of
   values; OPTIONAL).  A comma separated list of available image
   dimensions, written in the form "WxH", with width W and height H
   specified in pixels.  Example: a image dimension listed as "512x512"
   implies a 1x1 aspect ratio image (square) of 512 pixels on a side.
   The minimum size of any dimension is 32.  The maximum is 1024.  If
   the tag is missing or has an empty value, there is no default image
   dimension.  This lets a domain owner broadcast intent that no brand
   indicator should be used.

5.3.  Formal Definition

   The formal definition of the BIMI format, using [ABNF], is as
   follows:

   location-uri = URI ; "URI" is imported from [URI]; commas (ASCII ;
   0x2C) MUST be encoded

   bimi-record = bimi-version [bimi-sep bimi-formats] [bimi-sep bimi-
   locations] [bimi-sep bimi-image-sizes] [bimi-sep] ; components other
   than bimi-version ; may appear in any order

   bimi-version = "v" *WSP "=" *WSP %x42 %x49 %x4d %x49 %x31

   bimi-sep = *WSP %x3b *WSP

   bimi-size-list = bimi-size*( "," bimi-size) [ "," ] bimi-size = bimi-
   dimension ("x" / "X") bimi-dimension bimi-dimension = [FWS](2DIGIT /
   3DIGIT / 4DIGIT)[FWS]

5.4.  Indicator Discovery

   As stated above, the BIMI mechanism uses DNS TXT records to advertise
   preferences.  Preference discovery is accomplished via a method
   similar to the method used for [DMARC] records.  This method, and the
   important differences between BIMI and [DMARC] mechanisms, are
   discussed below.




Loder, et al.             Expires July 27, 2017                 [Page 9]

Internet-DrafBrand Indicators for Message Identification (B January 2017


   To balance the conflicting requirements of supporting wildcarding,
   allowing subdomain policy overrides, and limiting DNS query load,
   Clients should employ the following lookup scheme for the appropriate
   BIMI record for the message:

   1.  Start with the DNS domain found in the RFC5322.From header in the
       message.  Define this DNS domain as the Asserted Domain.

   2.  If the message for which the indicator is being determined
       specifies a selector value, use this value for the selector.
       Otherwise use the value 'default' for the selector

   3.  Clients MUST query the DNS for a BIMI TXT record at the DNS
       domain constructed by concatenating the selector, the string
       '_bimi', and the Asserted Domain.  A possibly empty set of
       records is returned.

   4.  Records that do not start with a "v=" tag that identifies the
       current version of BIMI are discarded.

   5.  If the set is now empty, the Client MUST query the DNS for a BIMI
       TXT record at the DNS domain constructed by concatenating the
       selector, the string '_bimi', and the Organizational Domain (as
       defined in [DMARC]) corresponding to the Asserted Domain.  A
       possibly empty set of records is returned.

   6.  Records that do not start with a "v=" tag that identifies the
       current version of BIMI are discarded.

   7.  If the remaining set contains multiple records or no records,
       indicator discovery terminates and BIMI processing is not
       performed for this message.

   8.  If the remaining set contains only a single record, this record
       is used for indicator discovery.

6.  Security Considerations

7.  Normative References

   [ABNF]     Overell, Crocker,., "Augmented BNF for Syntax
              Specifications: ABNF", January 2008,
              <http://www.rfc-editor.org/info/rfc5234>.

   [DKIM]     Kucherawy, Ed, Crocker,., "DomainKeys Identified Mail
              (DKIM) Signatures", September 2011,
              <http://www.rfc-editor.org/info/rfc6376>.




Loder, et al.             Expires July 27, 2017                [Page 10]

Internet-DrafBrand Indicators for Message Identification (B January 2017


   [DMARC]    Zwicky, Ed, Kucherawy,., "Domain-based Message
              Authentication, Reporting, and Conformance (DMARC)", March
              2015, <http://www.rfc-editor.org/info/rfc7489>.

   [DNS]      Mockapetris, P, ., "Domain names - implementation and
              specification", November 1987,
              <http://www.rfc-editor.org/info/rfc1035>.

   [EMAIL-ARCH]
              Crocker, D, ., "Internet Mail Architecture", July 2009,
              <http://www.rfc-editor.org/info/rfc5598>.

   [KEYWORDS]
              Bradner, S, ., "Key words for use in RFCs to Indicate
              Requirement Levels", March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [SMTP]     Klensin, J, ., "Simple Mail Transfer Protocol", October
              2008, <http://www.rfc-editor.org/info/rfc5321>.

   [SPF]      Kitterman, S, ., "Sender Policy Framework (SPF) for
              Authorizing Use of Domains in Email, Version 1", April
              2014, <http://www.rfc-editor.org/info/rfc7208>.

   [URI]      Masinter, Berners-Lee,., "Uniform Resource Identifier
              (URI): Generic Syntax", January 2005,
              <http://www.rfc-editor.org/info/rfc3986>.

Authors' Addresses

   Thede Loder
   Agari

   Email: tloder@agari.com


   Terry Zink
   Microsoft

   Email: tzink@exchange.microsoft.com


   Peter Goldstein
   ValiMail

   Email: peter@valimail.com





Loder, et al.             Expires July 27, 2017                [Page 11]
